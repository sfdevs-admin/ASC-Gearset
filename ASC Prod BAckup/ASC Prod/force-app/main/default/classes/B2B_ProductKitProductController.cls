public without sharing class B2B_ProductKitProductController {

    @AuraEnabled(cacheable=true)
    public static Map<String,Object> getKitRelatedProductItems(String productId) {
        Map<String,Object> responseMap = new Map<String,Object>();
        Map<String,List<Product_Kit_Product__c>> elementVsProductKitProductMap = new Map<String,List<Product_Kit_Product__c>>();
        Boolean isSuccess = false;
        system.debug('productId => '+productId);
        try {
            List<Product_Kit_Product__c> pkpList = new List<Product_Kit_Product__c>();
            pkpList = [SELECT Id, Child_Product__r.Product_Kit_Grouping__c, Child_Product__r.Parent_Sku__c, External_Id__c, Name, Parent_Product__c, Unit__c 
                                                FROM Product_Kit_Product__c 
                                                WHERE Parent_Product__c =: productId ORDER BY Child_Product__r.Parent_Sku__c ASC];

            if(!pkpList.isEmpty() ){
                for(Product_Kit_Product__c pkp : pkpList){
                    if(elementVsProductKitProductMap.containskey(pkp.Child_Product__r.Product_Kit_Grouping__c)){
                        List<Product_Kit_Product__c> existingPKP = elementVsProductKitProductMap.get(pkp.Child_Product__r.Product_Kit_Grouping__c);
                        existingPKP.add(pkp);
                        elementVsProductKitProductMap.put(pkp.Child_Product__r.Product_Kit_Grouping__c, existingPKP);
                    }else{
                        elementVsProductKitProductMap.put(pkp.Child_Product__r.Product_Kit_Grouping__c,new List<Product_Kit_Product__c>{pkp});
                    }
                }
                 //responseMap.put('Status','Success');
                 isSuccess = true;
                 responseMap.put('pkpList',pkpList);
                 responseMap.put('elementVsProductKitProductMap', elementVsProductKitProductMap);
            }else{
                responseMap.put('pkpList',pkpList);
                responseMap.put('ErrorMsg','No result returned');
            }
        } catch (Exception ex) {
            system.debug('ex => '+ex);
            responseMap.put('ExceptionMsg',ex.getMessage());
        }
        responseMap.put('isSuccess', isSuccess);
        system.debug('responseMap => '+responseMap);
        return responseMap;
    }
    
    public static void testCoverage(){
        Integer i = 0;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
    }

}